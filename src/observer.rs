use nalgebra::{dmatrix, DMatrix};
use crate::spectra::{SpectralDomain, StandardObserver};


#[derive(Debug)]
pub struct Observer {
	pub cmf : DMatrix<f64>,
	pub domain: SpectralDomain,
}

pub enum ObserverTag {
	CIE1931,
	CIE1960,
}

impl StandardObserver for Observer {}


/**
	CIE1931 2ยบ standard observer (from )
 */
pub fn cie1931() -> Observer {
	let  cmf = 
			dmatrix![
				0.0001299, 0.0002321, 0.0004149, 0.0007416, 0.001368, 0.002236, 0.004243, 0.00765, 0.01431, 0.02319,
				0.04351, 0.07763, 0.13438, 0.21477, 0.2839, 0.3285, 0.34828, 0.34806, 0.3362, 0.3187, 0.2908, 0.2511,
				0.19536, 0.1421, 0.09564, 0.05795001, 0.03201, 0.0147, 0.0049, 0.0024, 0.0093, 0.0291, 0.06327, 0.1096,
				0.1655, 0.2257499, 0.2904, 0.3597, 0.4334499, 0.5120501, 0.5945, 0.6784, 0.7621, 0.8425, 0.9163, 0.9786,
				1.0263, 1.0567, 1.0622, 1.0456, 1.0026, 0.9384, 0.8544499, 0.7514, 0.6424, 0.5419, 0.4479, 0.3608,
				0.2835, 0.2187, 0.1649, 0.1212, 0.0874, 0.0636, 0.04677, 0.0329, 0.0227, 0.01584, 0.01135916,
				0.008110916, 0.005790346, 0.004109457, 0.002899327, 0.00204919, 0.001439971, 0.000999949, 0.000690079,
				0.000476021, 0.000332301, 0.000234826, 0.000166151, 0.000117413, 8.30753E-05, 5.87065E-05, 4.15099E-05,
				2.93533E-05, 2.06738E-05, 1.45598E-05, 1.0254E-05, 7.22146E-06, 5.08587E-06, 3.58165E-06, 2.52253E-06,
				1.77651E-06, 1.25114E-06;

				0.000003917, 0.000006965, 0.00001239, 0.00002202, 0.000039, 0.000064, 0.00012, 0.000217, 0.000396,
				0.00064, 0.00121, 0.00218, 0.004, 0.0073, 0.0116, 0.01684, 0.023, 0.0298, 0.038, 0.048, 0.06, 0.0739,
				0.09098, 0.1126, 0.13902, 0.1693, 0.20802, 0.2586, 0.323, 0.4073, 0.503, 0.6082, 0.71, 0.7932, 0.862,
				0.9148501, 0.954, 0.9803, 0.9949501, 1.0, 0.995, 0.9786, 0.952, 0.9154, 0.87, 0.8163, 0.757, 0.6949,
				0.631, 0.5668, 0.503, 0.4412, 0.381, 0.321, 0.265, 0.217, 0.175, 0.1382, 0.107, 0.0816, 0.061, 0.04458,
				0.032, 0.0232, 0.017, 0.01192, 0.00821, 0.005723, 0.004102, 0.002929, 0.002091, 0.001484, 0.001047,
				0.00074, 0.00052, 0.0003611, 0.0002492, 0.0001719, 0.00012, 0.0000848, 0.00006, 0.0000424, 0.00003,
				0.0000212, 0.00001499, 0.0000106, 7.4657E-06, 5.2578E-06, 3.7029E-06, 2.6078E-06, 1.8366E-06,
				1.2934E-06, 9.1093E-07, 6.4153E-07, 4.5181E-07;

				0.0006061, 0.001086, 0.001946, 0.003486, 0.006450001, 0.01054999, 0.02005001, 0.03621, 0.06785001,
				0.1102, 0.2074, 0.3713, 0.6456, 1.0390501, 1.3856, 1.62296, 1.74706, 1.7826, 1.77211, 1.7441, 1.6692,
				1.5281, 1.28764, 1.0419, 0.8129501, 0.6162, 0.46518, 0.3533, 0.272, 0.2123, 0.1582, 0.1117, 0.07824999,
				0.05725001, 0.04216, 0.02984, 0.0203, 0.0134, 0.008749999, 0.005749999, 0.0039, 0.002749999, 0.0021,
				0.0018, 0.001650001, 0.0014, 0.0011, 0.001, 0.0008, 0.0006, 0.00034, 0.00024, 0.00019, 0.0001, 5E-05,
				0.00003, 0.00002, 0.00001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
				0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
				0.0];
	Observer { cmf, domain: SpectralDomain::new(72, 166, 50)}
}

/**
	CIE1964 10ยบ standard observer (data from [Coulour & Vision Research Laboratory UK](http://www.cvrl.org/cmfs.htm])
 */
pub fn cie1964() -> Observer {
	let  cmf = 
				dmatrix![
					1.222E-07, 9.1927E-07, 5.9586E-06, 0.000033266, 0.000159952, 0.00066244, 0.0023616, 0.0072423,
					0.0191097, 0.0434, 0.084736, 0.140638, 0.204492, 0.264737, 0.314679, 0.357719, 0.383734, 0.386726,
					0.370702, 0.342957, 0.302273, 0.254085, 0.195618, 0.132349, 0.080507, 0.041072, 0.016172, 0.005132,
					0.003816, 0.015444, 0.037465, 0.071358, 0.117749, 0.172953, 0.236491, 0.304213, 0.376772, 0.451584,
					0.529826, 0.616053, 0.705224, 0.793832, 0.878655, 0.951162, 1.01416, 1.0743, 1.11852, 1.1343,
					1.12399, 1.0891, 1.03048, 0.95074, 0.856297, 0.75493, 0.647467, 0.53511, 0.431567, 0.34369,
					0.268329, 0.2043, 0.152568, 0.11221, 0.0812606, 0.05793, 0.0408508, 0.028623, 0.0199413, 0.013842,
					0.00957688, 0.0066052, 0.00455263, 0.0031447, 0.00217496, 0.0015057, 0.00104476, 0.00072745,
					0.000508258, 0.00035638, 0.000250969, 0.00017773, 0.00012639, 0.000090151, 6.45258E-05, 0.000046339,
					3.34117E-05, 0.000024209, 1.76115E-05, 0.000012855, 9.41363E-06, 0.000006913, 5.09347E-06,
					3.7671E-06, 2.79531E-06, 0.000002082, 1.55314E-06;
					1.3398E-08, 1.0065E-07, 6.511E-07, 0.000003625, 0.000017364, 0.00007156, 0.0002534, 0.0007685,

					0.0020044, 0.004509, 0.008756, 0.014456, 0.021391, 0.029497, 0.038676, 0.049602, 0.062077, 0.074704,
					0.089456, 0.106256, 0.128201, 0.152761, 0.18519, 0.21994, 0.253589, 0.297665, 0.339133, 0.395379,
					0.460777, 0.53136, 0.606741, 0.68566, 0.761757, 0.82333, 0.875211, 0.92381, 0.961988, 0.9822,
					0.991761, 0.99911, 0.99734, 0.98238, 0.955552, 0.915175, 0.868934, 0.825623, 0.777405, 0.720353,
					0.658341, 0.593878, 0.527963, 0.461834, 0.398057, 0.339554, 0.283493, 0.228254, 0.179828, 0.140211,
					0.107633, 0.081187, 0.060281, 0.044096, 0.0318004, 0.0226017, 0.0159051, 0.0111303, 0.0077488,
					0.0053751, 0.00371774, 0.00256456, 0.00176847, 0.00122239, 0.00084619, 0.00058644, 0.00040741,
					0.000284041, 0.00019873, 0.00013955, 0.000098428, 0.000069819, 0.000049737, 3.55405E-05,
					0.000025486, 1.83384E-05, 0.000013249, 9.6196E-06, 7.0128E-06, 5.1298E-06, 3.76473E-06, 2.77081E-06,
					2.04613E-06, 1.51677E-06, 1.12809E-06, 8.4216E-07, 6.297E-07;

					5.35027E-07, 4.0283E-06, 2.61437E-05, 0.00014622, 0.000704776, 0.0029278, 0.0104822, 0.032344,
					0.0860109, 0.19712, 0.389366, 0.65676, 0.972542, 1.2825, 1.55348, 1.7985, 1.96728, 2.0273, 1.9948,
					1.9007, 1.74537, 1.5549, 1.31756, 1.0302, 0.772125, 0.57006, 0.415254, 0.302356, 0.218502, 0.159249,
					0.112044, 0.082248, 0.060709, 0.04305, 0.030451, 0.020584, 0.013676, 0.007918, 0.003988, 0.001091,
					0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
					0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
					0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0;
				];
	Observer { cmf, domain: SpectralDomain::new(72, 166, 50)}
}

#[test]
 fn testcie1931(){
	 println!("{:?}", cie1964());
 }
